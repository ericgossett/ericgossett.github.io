<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/component---src-layouts-index-js-3ef8ab9a449c73fd4e1a.js" as="script"/><link rel="preload" href="/component---src-templates-project-page-js-c391599eada3426ac091.js" as="script"/><link rel="preload" href="/path---tf-boilerplate-c45a4220ba8acc9f02d0.js" as="script"/><link rel="preload" href="/app-03bf8c1ef8ee9789dabc.js" as="script"/><link rel="preload" href="/commons-afb5782224ac01f1fa03.js" as="script"/><style data-styled-components="iZuvoZ kjLpJw dltHRE gwrIDM exaEvl frtNBT dTpISP cDjlmj">
/* sc-component-id: sc-bwzfXH */
.iZuvoZ{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-height:220px;padding-top:20px;} @media screen and (min-width:800px){.iZuvoZ{min-height:280px;padding-top:40px;}} @media screen and (min-width:1200px){.iZuvoZ{min-height:340px;padding-top:60px;}}
/* sc-component-id: sc-htpNat */
.kjLpJw{-webkit-text-decoration:none;text-decoration:none;font-size:1.5rem;color:#F3F99D;margin-top:5px;font-weight:bold;padding:5px 20px;border:3px solid #F3F99D;-webkit-transform:skewY(-1deg);-ms-transform:skewY(-1deg);transform:skewY(-1deg);} @media screen and (min-width:320px){.kjLpJw{font-size:1.5rem;}} @media screen and (min-width:800px){.kjLpJw{font-size:2.5rem;padding:5px 20px;}} @media screen and (min-width:1200px){.kjLpJw{font-size:3.0rem;padding:8px 30px;}}
/* sc-component-id: sc-bxivhb */
.dltHRE{margin-top:5px;color:#FF6AC1;padding:0px 8px;border:1px solid #FF6AC1;font-size:0.8rem;-webkit-transform:skewY(1deg);-ms-transform:skewY(1deg);transform:skewY(1deg);} @media screen and (min-width:800px){.dltHRE{font-size:1.24rem;padding:5px 8px;margin-top:10px;}} @media screen and (min-width:1200px){.dltHRE{margin-top:20px;}}
/* sc-component-id: sc-ifAKCX */
.dTpISP{margin:30px;text-align:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;font-size:0.8rem;}
/* sc-component-id: sc-EHOje */
.cDjlmj{color:#F3F99D;padding:4px 8px;border:1px solid #F3F99D;font-size:0.8rem;}
/* sc-component-id: sc-bZQynM */
.gwrIDM{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin:0 auto;height:100%;padding:0px 25px;} @media screen and (min-width:320px){.gwrIDM{width:100%;}} @media screen and (min-width:800px){.gwrIDM{max-width:788px;padding:0px 0px;}} @media screen and (min-width:1200px){.gwrIDM{max-width:1088px;padding:0px 0px;}}
/* sc-component-id: sc-gzVnrw */
.exaEvl{font-size:2.0rem;position:relative;display:inline-block;z-index:1;clear:both;margin-top:60px;color:#57C7FF;-webkit-transform:skewY(-1deg);-ms-transform:skewY(-1deg);transform:skewY(-1deg);}
/* sc-component-id: sc-dnqmqq */
.frtNBT{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin:0 auto;font-family:'Karla',sans-serif;height:100%;} @media screen and (min-width:320px){.frtNBT{width:100%;}} @media screen and (min-width:800px){.frtNBT{max-width:788px;}} @media screen and (min-width:1200px){.frtNBT{max-width:1088px;}}</style><title data-react-helmet="true">Eric Gossett - Tensorflow boilerplate</title><meta data-react-helmet="true" name="description" content="Sample"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><style id="gatsby-inlined-css">@import url(https://fonts.googleapis.com/css?family=IBM+Plex+Mono:300,300i,400,400i,500,600,700);code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}html{font-family:IBM Plex Mono,monospace;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:1em Karla,sans-serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:#dfdee1;background-color:#282a36;font-family:IBM Plex Mono,monospace;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt","kern"}img{max-width:100%;margin:0 0 1.45rem;padding:0}h1{font-size:2.25rem}h1,h2{margin:0 0 1.45rem;padding:0;color:#9aedfe;font-family:IBM Plex Mono,monospace;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{margin:0 0 1.45rem;padding:0;color:#9aedfe;font-family:IBM Plex Mono,monospace;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{margin:0 0 1.45rem;padding:0;color:#9aedfe;font-family:IBM Plex Mono,monospace;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{margin:0 0 1.45rem 1.45rem;padding:0;list-style-position:outside;list-style-image:none}dd,dl,p{margin:0 0 1.45rem;padding:0}p{line-height:1.5}figure{margin:0 0 1.45rem;padding:0}pre{margin-left:0;margin-right:0;margin-top:0;padding:0;margin-bottom:1.45rem!important;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{margin:0 0 calc(1.45rem - 1px);padding:0;background:rgba(0,0,0,.2);border:none;height:1px}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:0;padding-top:.2em;padding-bottom:.2em}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}@font-face{font-family:devicon;src:url(/static/devicon.681fa39a.eot);src:url(/static/devicon.681fa39a.eot?#iefix-hdf3wh) format("embedded-opentype"),url(/static/devicon.0f964a72.woff) format("woff"),url(/static/devicon.29f80b00.ttf) format("truetype"),url(/static/devicon.74e6e6c3.svg#devicon) format("svg");font-weight:400;font-style:normal}[class*=" devicon-"],[class^=devicon-]{font-family:devicon;speak:none;font-style:normal;font-weight:400;-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.devicon-sketch-line-wordmark:before{content:"\E94C"}.devicon-sketch-line:before{content:"\E94D"}.devicon-npm-original-wordmark:before{content:"\E952"}.devicon-ionic-original-wordmark:before{content:"\E953"}.devicon-ionic-original:before{content:"\E954"}.devicon-ember-original-wordmark:before{content:"\E955"}.devicon-electron-original-wordmark:before{content:"\E956"}.devicon-electron-original:before{content:"\E957"}.devicon-vagrant-plain-wordmark:before{content:"\E94E"}.devicon-vagrant-plain:before{content:"\E94F"}.devicon-yarn-plain-wordmark:before{content:"\E950"}.devicon-yarn-plain:before{content:"\E951"}.devicon-handlebars-plain-wordmark:before{content:"\E94A"}.devicon-handlebars-plain:before{content:"\E94B"}.devicon-couchdb-plain-wordmark:before{content:"\E948"}.devicon-couchdb-plain:before{content:"\E949"}.devicon-behance-plain-wordmark:before{content:"\E943"}.devicon-behance-plain:before{content:"\E945"}.devicon-linkedin-plain-wordmark:before{content:"\E946"}.devicon-linkedin-plain:before{content:"\E947"}.devicon-ceylon-plain-wordmark:before{content:"\E943"}.devicon-ceylon-plain:before{content:"\E944"}.devicon-elm-plain-wordmark:before{content:"\E941"}.devicon-elm-plain:before{content:"\E942"}.devicon-cakephp-plain-wordmark:before{content:"\E93F"}.devicon-cakephp-plain:before{content:"\E940"}.devicon-stylus-original:before{content:"\E93E"}.devicon-express-original-wordmark:before{content:"\E93C"}.devicon-express-original:before{content:"\E93D"}.devicon-devicon-plain-wordmark:before{content:"\E93A"}.devicon-devicon-plain:before{content:"\E93B"}.devicon-intellij-plain-wordmark:before{content:"\E932"}.devicon-intellij-plain:before{content:"\E933"}.devicon-pycharm-plain-wordmark:before{content:"\E934"}.devicon-pycharm-plain:before{content:"\E935"}.devicon-rubymine-plain-wordmark:before{content:"\E936"}.devicon-rubymine-plain:before{content:"\E937"}.devicon-webstorm-plain-wordmark:before{content:"\E938"}.devicon-webstorm-plain:before{content:"\E939"}.devicon-tomcat-line-wordmark:before{content:"\E92C"}.devicon-tomcat-line:before{content:"\E92D"}.devicon-vuejs-line-wordmark:before{content:"\E92E"}.devicon-vuejs-line:before{content:"\E92F"}.devicon-vuejs-plain-wordmark:before{content:"\E930"}.devicon-vuejs-plain:before{content:"\E931"}.devicon-swift-plain-wordmark:before{content:"\E92A"}.devicon-swift-plain:before{content:"\E92B"}.devicon-webpack-plain-wordmark:before{content:"\E928"}.devicon-webpack-plain:before{content:"\E929"}.devicon-visualstudio-plain-wordmark:before{content:"\E926"}.devicon-visualstudio-plain:before{content:"\E927"}.devicon-slack-plain-wordmark:before{content:"\E924"}.devicon-slack-plain:before{content:"\E925"}.devicon-facebook-original:before,.devicon-facebook-plain:before{content:"\E91C"}.devicon-typescript-original:before,.devicon-typescript-plain:before{content:"\E920"}.devicon-babel-original:before,.devicon-babel-plain:before{content:"\E921"}.devicon-mocha-plain:before{content:"\E919"}.devicon-jasmine-plain-wordmark:before{content:"\E91B"}.devicon-jasmine-plain:before{content:"\E91A"}.devicon-gatling-plain-wordmark:before{content:"\E918"}.devicon-gatling-plain:before{content:"\E917"}.devicon-ssh-original-wordmark:before,.devicon-ssh-plain-wordmark:before{content:"\E916"}.devicon-ssh-original:before,.devicon-ssh-plain:before{content:"\E915"}.devicon-sourcetree-original-wordmark:before,.devicon-sourcetree-plain-wordmark:before{content:"\E914"}.devicon-sourcetree-original:before,.devicon-sourcetree-plain:before{content:"\E913"}.devicon-phpstorm-plain-wordmark:before{content:"\E912"}.devicon-phpstorm-plain:before{content:"\E911"}.devicon-protractor-plain-wordmark:before{content:"\E901"}.devicon-protractor-plain:before{content:"\E900"}.devicon-gradle-plain-wordmark:before{content:"\E8F1"}.devicon-gradle-plain:before{content:"\E902"}.devicon-cucumber-plain-wordmark:before{content:"\E905"}.devicon-cucumber-plain:before{content:"\E904"}.devicon-jeet-plain-wordmark:before{content:"\E906"}.devicon-jeet-plain:before{content:"\E903"}.devicon-gitlab-plain-wordmark:before{content:"\E908"}.devicon-gitlab-plain:before{content:"\E907"}.devicon-github-original-wordmark:before,.devicon-github-plain-wordmark:before{content:"\E90A"}.devicon-github-original:before,.devicon-github-plain:before{content:"\E909"}.devicon-d3js-plain:before{content:"\E90C"}.devicon-confluence-original-wordmark:before,.devicon-confluence-plain-wordmark:before{content:"\E90E"}.devicon-confluence-original:before,.devicon-confluence-plain:before{content:"\E90D"}.devicon-bitbucket-original-wordmark:before,.devicon-bitbucket-plain-wordmark:before{content:"\E910"}.devicon-bitbucket-original:before,.devicon-bitbucket-plain:before{content:"\E90F"}.devicon-safari-line-wordmark:before{content:"\E632"}.devicon-safari-line:before{content:"\E63A"}.devicon-safari-plain-wordmark:before{content:"\E63B"}.devicon-safari-plain:before{content:"\E63C"}.devicon-jetbrains-line-wordmark:before,.devicon-jetbrains-line:before,.devicon-jetbrains-plain-wordmark:before,.devicon-jetbrains-plain:before{content:"\E63D"}.devicon-django-line-wordmark:before,.devicon-django-line:before{content:"\E63E"}.devicon-django-plain-wordmark:before,.devicon-django-plain:before{content:"\E63F"}.devicon-gimp-plain:before{content:"\E633"}.devicon-redhat-plain-wordmark:before{content:"\E62A"}.devicon-redhat-plain:before{content:"\E62B"}.devicon-cplusplus-line-wordmark:before,.devicon-cplusplus-line:before{content:"\E634"}.devicon-cplusplus-plain-wordmark:before,.devicon-cplusplus-plain:before{content:"\E635"}.devicon-csharp-line-wordmark:before,.devicon-csharp-line:before{content:"\E636"}.devicon-csharp-plain-wordmark:before,.devicon-csharp-plain:before{content:"\E637"}.devicon-c-line-wordmark:before,.devicon-c-line:before{content:"\E638"}.devicon-c-plain-wordmark:before,.devicon-c-plain:before{content:"\E639"}.devicon-nodewebkit-line-wordmark:before{content:"\E611"}.devicon-nodewebkit-line:before{content:"\E612"}.devicon-nodewebkit-plain-wordmark:before{content:"\E613"}.devicon-nodewebkit-plain:before{content:"\E614"}.devicon-nginx-original-wordmark:before,.devicon-nginx-original:before,.devicon-nginx-plain-wordmark:before,.devicon-nginx-plain:before{content:"\E615"}.devicon-erlang-plain-wordmark:before{content:"\E616"}.devicon-erlang-plain:before{content:"\E617"}.devicon-doctrine-line-wordmark:before{content:"\E618"}.devicon-doctrine-line:before{content:"\E619"}.devicon-doctrine-plain-wordmark:before{content:"\E61A"}.devicon-doctrine-plain:before{content:"\E625"}.devicon-apache-line-wordmark:before{content:"\E626"}.devicon-apache-line:before{content:"\E627"}.devicon-apache-plain-wordmark:before{content:"\E628"}.devicon-apache-plain:before{content:"\E629"}.devicon-go-line:before{content:"\E610"}.devicon-redis-plain-wordmark:before{content:"\E606"}.devicon-redis-plain:before{content:"\E607"}.devicon-meteor-plain-wordmark:before{content:"\E608"}.devicon-meteor-plain:before{content:"\E609"}.devicon-heroku-line-wordmark:before,.devicon-heroku-original-wordmark:before{content:"\E60A"}.devicon-heroku-line:before,.devicon-heroku-original:before{content:"\E60B"}.devicon-heroku-plain-wordmark:before{content:"\E60C"}.devicon-heroku-plain:before{content:"\E60F"}.devicon-go-plain:before{content:"\E61B"}.devicon-docker-plain-wordmark:before{content:"\E61E"}.devicon-docker-plain:before{content:"\E61F"}.devicon-amazonwebservices-original:before,.devicon-amazonwebservices-plain:before{content:"\E603"}.devicon-amazonwebservices-plain-wordmark:before{content:"\E604"}.devicon-android-plain-wordmark:before{content:"\E60D"}.devicon-android-plain:before{content:"\E60E"}.devicon-angularjs-plain-wordmark:before{content:"\E61C"}.devicon-angularjs-plain:before{content:"\E61D"}.devicon-appcelerator-original:before,.devicon-appcelerator-plain:before{content:"\E620"}.devicon-appcelerator-plain-wordmark:before{content:"\E621"}.devicon-apple-original:before,.devicon-apple-plain:before{content:"\E622"}.devicon-atom-original-wordmark:before,.devicon-atom-plain-wordmark:before{content:"\E623"}.devicon-atom-original:before,.devicon-atom-plain:before{content:"\E624"}.devicon-backbonejs-plain-wordmark:before{content:"\E62C"}.devicon-backbonejs-plain:before{content:"\E62D"}.devicon-bootstrap-plain-wordmark:before{content:"\E62E"}.devicon-bootstrap-plain:before{content:"\E62F"}.devicon-bower-line-wordmark:before{content:"\E630"}.devicon-bower-line:before{content:"\E631"}.devicon-bower-plain-wordmark:before{content:"\E64E"}.devicon-bower-plain:before{content:"\E64F"}.devicon-chrome-plain-wordmark:before{content:"\E665"}.devicon-chrome-plain:before{content:"\E666"}.devicon-codeigniter-plain-wordmark:before{content:"\E667"}.devicon-codeigniter-plain:before{content:"\E668"}.devicon-coffeescript-original-wordmark:before,.devicon-coffeescript-plain-wordmark:before{content:"\E669"}.devicon-coffeescript-original:before,.devicon-coffeescript-plain:before{content:"\E66A"}.devicon-css3-plain-wordmark:before{content:"\E678"}.devicon-css3-plain:before{content:"\E679"}.devicon-debian-plain-wordmark:before{content:"\E67E"}.devicon-debian-plain:before{content:"\E67F"}.devicon-dot-net-plain-wordmark:before{content:"\E6D3"}.devicon-dot-net-plain:before{content:"\E6D4"}.devicon-drupal-plain-wordmark:before{content:"\E6E2"}.devicon-drupal-plain:before{content:"\E6E3"}.devicon-firefox-plain-wordmark:before{content:"\E75D"}.devicon-firefox-plain:before{content:"\E75E"}.devicon-foundation-plain-wordmark:before{content:"\E7A2"}.devicon-foundation-plain:before{content:"\E7A3"}.devicon-git-plain-wordmark:before{content:"\E7A7"}.devicon-git-plain:before{content:"\E7A8"}.devicon-google-original-wordmark:before,.devicon-google-plain-wordmark:before{content:"\E91D"}.devicon-google-original:before,.devicon-google-plain:before{content:"\E91E"}.devicon-grunt-line-wordmark:before{content:"\E7A9"}.devicon-grunt-line:before{content:"\E7AA"}.devicon-grunt-plain-wordmark:before{content:"\E7EA"}.devicon-grunt-plain:before{content:"\E7EB"}.devicon-gulp-plain:before{content:"\E7EC"}.devicon-html5-plain-wordmark:before{content:"\E7F6"}.devicon-html5-plain:before{content:"\E7F7"}.devicon-ie10-original:before,.devicon-ie10-plain:before{content:"\E7F8"}.devicon-illustrator-line:before{content:"\E7F9"}.devicon-illustrator-plain:before{content:"\E7FA"}.devicon-inkscape-plain-wordmark:before{content:"\E834"}.devicon-inkscape-plain:before{content:"\E835"}.devicon-java-plain-wordmark:before{content:"\E841"}.devicon-java-plain:before{content:"\E842"}.devicon-javascript-plain:before{content:"\E845"}.devicon-jquery-plain-wordmark:before{content:"\E849"}.devicon-jquery-plain:before{content:"\E84A"}.devicon-krakenjs-plain-wordmark:before{content:"\E84F"}.devicon-krakenjs-plain:before{content:"\E850"}.devicon-laravel-plain-wordmark:before{content:"\E851"}.devicon-laravel-plain:before{content:"\E852"}.devicon-less-plain-wordmark:before{content:"\E853"}.devicon-linux-plain:before{content:"\EB1C"}.devicon-mongodb-plain-wordmark:before{content:"\EB43"}.devicon-mongodb-plain:before{content:"\EB44"}.devicon-moodle-plain-wordmark:before{content:"\EB5A"}.devicon-moodle-plain:before{content:"\EB5B"}.devicon-mysql-plain-wordmark:before{content:"\EB60"}.devicon-mysql-plain:before{content:"\EB61"}.devicon-nodejs-plain-wordmark:before{content:"\EB69"}.devicon-nodejs-plain:before{content:"\EB6A"}.devicon-oracle-original:before,.devicon-oracle-plain:before{content:"\EB6B"}.devicon-photoshop-line:before{content:"\EB6C"}.devicon-photoshop-plain:before{content:"\EB6D"}.devicon-php-plain:before{content:"\EB71"}.devicon-postgresql-plain-wordmark:before{content:"\EB7C"}.devicon-postgresql-plain:before{content:"\EB7D"}.devicon-python-plain-wordmark:before{content:"\EB88"}.devicon-python-plain:before{content:"\EB89"}.devicon-rails-plain-wordmark:before{content:"\EBA2"}.devicon-rails-plain:before{content:"\EBA3"}.devicon-react-original-wordmark:before,.devicon-react-plain-wordmark:before{content:"\E600"}.devicon-react-original:before,.devicon-react-plain:before{content:"\E601"}.devicon-ruby-plain-wordmark:before{content:"\EBC9"}.devicon-ruby-plain:before{content:"\EBCA"}.devicon-sass-original:before,.devicon-sass-plain:before{content:"\EBCB"}.devicon-sequelize-original-wordmark:before,.devicon-sequelize-plain-wordmark:before{content:"\E922"}.devicon-sequelize-original:before,.devicon-sequelize-plain:before{content:"\E923"}.devicon-symfony-original-wordmark:before,.devicon-symfony-plain-wordmark:before{content:"\E602"}.devicon-symfony-original:before,.devicon-symfony-plain:before{content:"\E605"}.devicon-travis-plain-wordmark:before{content:"\EBCC"}.devicon-travis-plain:before{content:"\EBCD"}.devicon-trello-plain-wordmark:before{content:"\EBCE"}.devicon-trello-plain:before{content:"\EBCF"}.devicon-twitter-original:before,.devicon-twitter-plain:before{content:"\E91F"}.devicon-ubuntu-plain-wordmark:before{content:"\EBD0"}.devicon-ubuntu-plain:before{content:"\EBD1"}.devicon-vim-plain:before{content:"\EBF3"}.devicon-windows8-original-wordmark:before,.devicon-windows8-plain-wordmark:before{content:"\EBF4"}.devicon-windows8-original:before,.devicon-windows8-plain:before{content:"\EBF5"}.devicon-wordpress-plain-wordmark:before{content:"\EBFD"}.devicon-wordpress-plain:before{content:"\EBFE"}.devicon-yii-plain-wordmark:before{content:"\EC01"}.devicon-yii-plain:before{content:"\EC02"}.devicon-zend-plain-wordmark:before{content:"\EC03"}.devicon-zend-plain:before{content:"\EC04"}.devicon-sketch-line-wordmark.colored,.devicon-sketch-line.colored{color:#fdad00}.devicon-npm-original-wordmark.colored{color:#cb3837}.devicon-ionic-original-wordmark.colored,.devicon-ionic-original.colored{color:#4e8ef7}.devicon-ember-original-wordmark.colored{color:#dd3f24}.devicon-electron-original-wordmark.colored,.devicon-electron-original.colored{color:#47848f}.devicon-vagrant-plain-wordmark.colored,.devicon-vagrant-plain.colored{color:#127eff}.devicon-yarn-plain-wordmark.colored,.devicon-yarn-plain.colored{color:#2c8ebb}.devicon-handlebars-plain-wordmark.colored,.devicon-handlebars-plain.colored{color:#000}.devicon-couchdb-plain-wordmark.colored,.devicon-couchdb-plain.colored{color:#e42528}.devicon-behance-plain-wordmark.colored,.devicon-behance-plain.colored{color:#0071e0}.devicon-linkedin-plain-wordmark.colored,.devicon-linkedin-plain.colored{color:#0076b2}.devicon-ceylon-plain-wordmark.colored,.devicon-ceylon-plain.colored{color:#ab710a}.devicon-elm-plain-wordmark.colored,.devicon-elm-plain.colored{color:#34495e}.devicon-cakephp-plain-wordmark.colored,.devicon-cakephp-plain.colored{color:#d43d44}.devicon-stylus-original.colored{color:#333}.devicon-express-original-wordmark.colored,.devicon-express-original.colored{color:#444}.devicon-devicon-plain-wordmark.colored,.devicon-devicon-plain.colored{color:#60be86}.devicon-intellij-plain-wordmark.colored,.devicon-intellij-plain.colored{color:#136ba2}.devicon-pycharm-plain-wordmark.colored,.devicon-pycharm-plain.colored{color:#4d8548}.devicon-rubymine-plain-wordmark.colored,.devicon-rubymine-plain.colored{color:#c12c4c}.devicon-webstorm-plain-wordmark.colored,.devicon-webstorm-plain.colored{color:#2788b5}.devicon-tomcat-line-wordmark.colored,.devicon-tomcat-line.colored{color:#d1a41a}.devicon-vuejs-line-wordmark.colored,.devicon-vuejs-line.colored,.devicon-vuejs-plain-wordmark.colored,.devicon-vuejs-plain.colored{color:#41b883}.devicon-swift-plain-wordmark.colored,.devicon-swift-plain.colored{color:#f05138}.devicon-webpack-plain-wordmark.colored,.devicon-webpack-plain.colored{color:#1c78c0}.devicon-visualstudio-plain-wordmark.colored,.devicon-visualstudio-plain.colored{color:#68217a}.devicon-slack-plain-wordmark.colored,.devicon-slack-plain.colored{color:#2d333a}.devicon-gatling-plain-wordmark.colored,.devicon-gatling-plain.colored{color:#e77500}.devicon-ssh-original-wordmark.colored,.devicon-ssh-original.colored,.devicon-ssh-plain-wordmark.colored,.devicon-ssh-plain.colored{color:#231f20}.devicon-sourcetree-original-wordmark.colored,.devicon-sourcetree-original.colored,.devicon-sourcetree-plain-wordmark.colored,.devicon-sourcetree-plain.colored{color:#205081}.devicon-phpstorm-plain-wordmark.colored,.devicon-phpstorm-plain.colored{color:#5058a6}.devicon-protractor-plain-wordmark.colored,.devicon-protractor-plain.colored{color:#b7111d}.devicon-cucumber-plain-wordmark.colored,.devicon-cucumber-plain.colored{color:#00a818}.devicon-gradle-plain-wordmark.colored,.devicon-gradle-plain.colored{color:#02303a}.devicon-jeet-plain-wordmark.colored,.devicon-jeet-plain.colored{color:#ff664a}.devicon-gitlab-plain-wordmark.colored,.devicon-gitlab-plain.colored{color:#e24329}.devicon-github-original-wordmark.colored,.devicon-github-original.colored,.devicon-github-plain-wordmark.colored,.devicon-github-plain.colored{color:#181616}.devicon-d3js-plain.colored{color:#f7974e}.devicon-bitbucket-original-wordmark.colored,.devicon-bitbucket-original.colored,.devicon-bitbucket-plain-wordmark.colored,.devicon-bitbucket-plain.colored,.devicon-confluence-original-wordmark.colored,.devicon-confluence-original.colored,.devicon-confluence-plain-wordmark.colored,.devicon-confluence-plain.colored{color:#205081}.devicon-amazonwebservices-original.colored,.devicon-amazonwebservices-plain-wordmark.colored,.devicon-amazonwebservices-plain.colored{color:#f7a80d}.devicon-android-plain-wordmark.colored,.devicon-android-plain.colored{color:#a4c439}.devicon-angularjs-plain-wordmark.colored,.devicon-angularjs-plain.colored{color:#c4473a}.devicon-apache-line-wordmark.colored,.devicon-apache-line.colored,.devicon-apache-plain-wordmark.colored,.devicon-apache-plain.colored{color:#303284}.devicon-appcelerator-original.colored,.devicon-appcelerator-plain-wordmark.colored,.devicon-appcelerator-plain.colored{color:#ac162c}.devicon-apple-original.colored,.devicon-apple-plain.colored{color:#000}.devicon-atom-original-wordmark.colored,.devicon-atom-original.colored,.devicon-atom-plain-wordmark.colored,.devicon-atom-plain.colored{color:#67595d}.devicon-babel-original.colored,.devicon-babel-plain.colored{color:#f9dc3e}.devicon-backbonejs-plain-wordmark.colored,.devicon-backbonejs-plain.colored{color:#002a41}.devicon-bootstrap-plain-wordmark.colored,.devicon-bootstrap-plain.colored{color:#59407f}.devicon-bower-line-wordmark.colored,.devicon-bower-line.colored,.devicon-bower-plain-wordmark.colored,.devicon-bower-plain.colored{color:#ef5734}.devicon-c-line-wordmark.colored,.devicon-c-line.colored,.devicon-c-plain-wordmark.colored,.devicon-c-plain.colored{color:#03599c}.devicon-chrome-plain-wordmark.colored,.devicon-chrome-plain.colored{color:#ce4e4e}.devicon-codeigniter-plain-wordmark.colored,.devicon-codeigniter-plain.colored{color:#ee4323}.devicon-coffeescript-original-wordmark.colored,.devicon-coffeescript-original.colored,.devicon-coffeescript-plain-wordmark.colored,.devicon-coffeescript-plain.colored{color:#28334c}.devicon-cplusplus-line-wordmark.colored,.devicon-cplusplus-line.colored,.devicon-cplusplus-plain-wordmark.colored,.devicon-cplusplus-plain.colored{color:#9c033a}.devicon-csharp-line-wordmark.colored,.devicon-csharp-line.colored,.devicon-csharp-plain-wordmark.colored,.devicon-csharp-plain.colored{color:#68217a}.devicon-css3-plain-wordmark.colored,.devicon-css3-plain.colored{color:#3d8fc6}.devicon-debian-plain-wordmark.colored,.devicon-debian-plain.colored{color:#a80030}.devicon-django-line-wordmark.colored,.devicon-django-line.colored,.devicon-django-plain-wordmark.colored,.devicon-django-plain.colored{color:#003a2b}.devicon-docker-plain-wordmark.colored,.devicon-docker-plain.colored{color:#019bc6}.devicon-doctrine-line-wordmark.colored,.devicon-doctrine-line.colored,.devicon-doctrine-plain-wordmark.colored,.devicon-doctrine-plain.colored{color:#f56d39}.devicon-dot-net-plain-wordmark.colored,.devicon-dot-net-plain.colored{color:#1384c8}.devicon-drupal-plain-wordmark.colored,.devicon-drupal-plain.colored{color:#0073ba}.devicon-erlang-plain-wordmark.colored,.devicon-erlang-plain.colored{color:#a90533}.devicon-facebook-original.colored,.devicon-facebook-plain.colored{color:#3d5a98}.devicon-firefox-plain-wordmark.colored,.devicon-firefox-plain.colored{color:#dd732a}.devicon-foundation-plain-wordmark.colored,.devicon-foundation-plain.colored{color:#008cba}.devicon-gimp-plain-wordmark.colored,.devicon-gimp-plain.colored{color:#716955}.devicon-git-plain-wordmark.colored,.devicon-git-plain.colored{color:#f34f29}.devicon-go-line.colored,.devicon-go-plain.colored{color:#000}.devicon-google-original-wordmark.colored,.devicon-google-original.colored,.devicon-google-plain-wordmark.colored,.devicon-google-plain.colored{color:#587dbd}.devicon-grunt-line-wordmark.colored,.devicon-grunt-line.colored,.devicon-grunt-plain-wordmark.colored,.devicon-grunt-plain.colored{color:#fcaa1a}.devicon-gulp-plain.colored{color:#eb4a4b}.devicon-heroku-line-wordmark.colored,.devicon-heroku-line.colored,.devicon-heroku-original-wordmark.colored,.devicon-heroku-original.colored,.devicon-heroku-plain-wordmark.colored,.devicon-heroku-plain.colored{color:#6762a6}.devicon-html5-plain-wordmark.colored,.devicon-html5-plain.colored{color:#e54d26}.devicon-ie10-original.colored,.devicon-ie10-plain.colored{color:#1ebbee}.devicon-illustrator-line.colored,.devicon-illustrator-plain.colored{color:#faa625}.devicon-inkscape-plain-wordmark.colored,.devicon-inkscape-plain.colored{color:#000}.devicon-java-plain-wordmark.colored,.devicon-java-plain.colored{color:#ea2d2e}.devicon-jasmine-plain-wordmark.colored,.devicon-jasmine-plain.colored{color:#8a4182}.devicon-javascript-plain.colored{color:#f0db4f}.devicon-jetbrains-line-wordmark.colored,.devicon-jetbrains-line.colored,.devicon-jetbrains-plain-wordmark.colored,.devicon-jetbrains-plain.colored{color:#f68b1f}.devicon-jquery-plain-wordmark.colored,.devicon-jquery-plain.colored{color:#0769ad}.devicon-krakenjs-plain-wordmark.colored,.devicon-krakenjs-plain.colored{color:#0081c2}.devicon-laravel-plain-wordmark.colored,.devicon-laravel-plain.colored{color:#fd4f31}.devicon-less-plain-wordmark.colored{color:#2a4d80}.devicon-linux-plain.colored{color:#000}.devicon-meteor-plain-wordmark.colored,.devicon-meteor-plain.colored{color:#df5052}.devicon-mocha-plain.colored{color:#8d6748}.devicon-mongodb-plain-wordmark.colored,.devicon-mongodb-plain.colored{color:#4faa41}.devicon-moodle-plain-wordmark.colored,.devicon-moodle-plain.colored{color:#f7931e}.devicon-mysql-plain-wordmark.colored,.devicon-mysql-plain.colored{color:#00618a}.devicon-nginx-original-wordmark.colored,.devicon-nginx-original.colored,.devicon-nginx-plain-wordmark.colored,.devicon-nginx-plain.colored{color:#090}.devicon-nodejs-plain-wordmark.colored,.devicon-nodejs-plain.colored{color:#83cd29}.devicon-nodewebkit-line-wordmark.colored,.devicon-nodewebkit-line.colored,.devicon-nodewebkit-plain-wordmark.colored,.devicon-nodewebkit-plain.colored{color:#3d3b47}.devicon-oracle-original.colored,.devicon-oracle-plain-wordmark.colored,.devicon-oracle-plain.colored{color:#ea1b22}.devicon-photoshop-line.colored,.devicon-photoshop-plain.colored{color:#80b5e2}.devicon-php-plain.colored{color:#6181b6}.devicon-postgresql-plain-wordmark.colored,.devicon-postgresql-plain.colored{color:#336791}.devicon-python-plain-wordmark.colored,.devicon-python-plain.colored{color:#ffd845}.devicon-rails-plain-wordmark.colored,.devicon-rails-plain.colored{color:#a62c46}.devicon-ruby-plain-wordmark.colored,.devicon-ruby-plain.colored{color:#d91404}.devicon-safari-line-wordmark.colored,.devicon-safari-line.colored,.devicon-safari-plain-wordmark.colored,.devicon-safari-plain.colored{color:#1b88ca}.devicon-react-original-wordmark.colored,.devicon-react-original.colored,.devicon-react-plain-wordmark.colored,.devicon-react-plain.colored{color:#61dafb}.devicon-redhat-original-wordmark.colored,.devicon-redhat-original.colored,.devicon-redhat-plain-wordmark.colored,.devicon-redhat-plain.colored{color:#e93442}.devicon-redis-plain-wordmark.colored,.devicon-redis-plain.colored{color:#d82c20}.devicon-sass-original.colored,.devicon-sass-plain-wordmark.colored,.devicon-sass-plain.colored{color:#c69}.devicon-sequelize-original-wordmark.colored,.devicon-sequelize-original.colored,.devicon-sequelize-plain-wordmark.colored,.devicon-sequelize-plain.colored{color:#3b4b72}.devicon-symfony-original-wordmark.colored,.devicon-symfony-original.colored,.devicon-symfony-plain-wordmark.colored,.devicon-symfony-plain.colored{color:#1a171b}.devicon-travis-plain-wordmark.colored,.devicon-travis-plain.colored{color:#bb2031}.devicon-trello-plain-wordmark.colored,.devicon-trello-plain.colored{color:#23719f}.devicon-twitter-original.colored,.devicon-twitter-plain.colored{color:#1da1f2}.devicon-typescript-original.colored,.devicon-typescript-plain.colored{color:#007acc}.devicon-ubuntu-plain-wordmark.colored,.devicon-ubuntu-plain.colored{color:#dd4814}.devicon-vim-plain.colored{color:#179a33}.devicon-windows8-original-wordmark.colored,.devicon-windows8-original.colored,.devicon-windows8-plain-wordmark.colored,.devicon-windows8-plain.colored{color:#00adef}.devicon-wordpress-plain-wordmark.colored,.devicon-wordpress-plain.colored{color:#494949}.devicon-yii-plain-wordmark.colored,.devicon-yii-plain.colored{color:#0073bb}.devicon-zend-plain-wordmark.colored,.devicon-zend-plain.colored{color:#68b604}</style></head><body><div id="___gatsby"><div data-reactroot="" data-reactid="1" data-react-checksum="105107148"><!-- react-empty: 2 --><div class="sc-bwzfXH iZuvoZ" data-reactid="3"><a class="sc-htpNat kjLpJw" href="/" data-reactid="4"> Eric Gossett </a><div class="sc-bxivhb dltHRE" data-reactid="5"> scientist | developer </div></div><div data-reactid="6"><div style="margin-top:-145px;" data-reactid="7"><div class="sc-bZQynM gwrIDM" data-reactid="8"><span data-reactid="9"><!-- react-text: 10 --> <!-- /react-text --><div class="sc-gzVnrw exaEvl" color="#57C7FF" data-reactid="11"><!-- react-text: 12 --> <!-- /react-text --><!-- react-text: 13 -->Tensorflow boilerplate<!-- /react-text --><!-- react-text: 14 --> <!-- /react-text --></div><!-- react-text: 15 --> <!-- /react-text --></span></div><div style="margin-top:30px;" data-reactid="16"><div class="sc-dnqmqq frtNBT" data-reactid="17"><!-- react-empty: 18 --><div class="blog-post" data-reactid="19"><div class="blog-post-content" data-reactid="20"><p>I found that it is not to hard for Tensorflow projects to become monoliths if one does not take some consideration when organizing their code. As a result, I decided to search look for some guidelines on how to structure a Tensorflow project and came across this popular template <a href="https://github.com/MrGemy95/Tensorflow-Project-Template">link</a>. Looking through the code, I found a lot to love, however, like any boilerplate I also found some things I did not like. This inspired me to write my own boilerplate, taking insipiration from what I liked in this project, while giving it my own flare.</p>
<p><strong>Repo:</strong> <a href="https://github.com/ericgossett/tf-boilerplate">https://github.com/ericgossett/tf-boilerplate</a></p>
<h2>Structure</h2>
<div class="gatsby-highlight" data-language="bash">
      <pre class="language-bash"><code class="language-bash">core/
    exceptions.py
    logger.py
    model.py
    trainer.py
    validators.py
logs/
snapshots/
main.py</code></pre>
      </div>
<ul>
<li><strong>core</strong> - contains the main functionality of the boilerplate.</li>
<li><strong>logs</strong> - Where session logs are stored for tensorboard visualization.</li>
<li><strong>snapshots</strong> - Where models are saved.</li>
</ul>
<h2>Core</h2>
<p>As seen in the template this is based off of I also decided to use the same architecture consisting of a model, trainer and logger component. </p>
<h3>Model</h3>
<p>The model component is an abstract class containing the following: </p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Model</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Base class for a Tensorflow models
    Args:
        config (dict): The configuration.
    """</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">:</span>
        config_validator<span class="token punctuation">(</span>config<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>config <span class="token operator">=</span> config
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>saver <span class="token operator">=</span> <span class="token boolean">None</span>
        <span class="token keyword">with</span> tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">'global_step'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>global_step <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>
                <span class="token number">0</span><span class="token punctuation">,</span>
                trainable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                name<span class="token operator">=</span><span class="token string">'global_step'</span>
            <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>x <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>data <span class="token operator">=</span> tf<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Dataset<span class="token punctuation">.</span>from_tensor_slices<span class="token punctuation">(</span>
            <span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span>batch<span class="token punctuation">(</span>
            config<span class="token punctuation">[</span><span class="token string">'batch_size'</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>data_iter <span class="token operator">=</span> self<span class="token punctuation">.</span>data<span class="token punctuation">.</span>make_initializable_iterator<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">model_constructor</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Abstract method used to define the model in the derived class."""</span>
        <span class="token keyword">raise</span> NotImplementedError

    <span class="token keyword">def</span> <span class="token function">save</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sess<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Saves a snapshot of the model
        Args:
            sess (tf.Session): The current session.
        """</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>saver <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> SaverNotInitialized<span class="token punctuation">(</span><span class="token punctuation">(</span>
                <span class="token string">'saver not defined, please make sure '</span>
                <span class="token string">'self.saver = tf.train.Saver('</span>
                <span class="token string">'max_to_keep=config[\'saver_max_to_keep\']'</span>
                <span class="token string">') is in the constructor.'</span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Saving model...'</span><span class="token punctuation">)</span>
        save_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'save_dir'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>name
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>saver<span class="token punctuation">.</span>save<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> save_dir <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>name<span class="token punctuation">,</span> self<span class="token punctuation">.</span>global_step<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Save completed.\n'</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">load</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sess<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""loads the last snapshot of the model
        Args:
            sess (tf.Session): The current session.
        """</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>saver <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> SaverNotInitialized<span class="token punctuation">(</span><span class="token punctuation">(</span>
                <span class="token string">'saver not defined, please make sure '</span>
                <span class="token string">'self.saver = tf.train.Saver('</span>
                <span class="token string">'max_to_keep=config[\'saver_max_to_keep\']'</span>
                <span class="token string">') is in the constructor.'</span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span>
        save_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'save_dir'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>name
        <span class="token punctuation">)</span>
        latest_checkpoint <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>latest_checkpoint<span class="token punctuation">(</span>save_dir<span class="token punctuation">)</span>
        <span class="token keyword">if</span> latest_checkpoint<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>
                <span class="token string">'Loading model checkpoint {} ...\n'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>latest_checkpoint<span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>saver<span class="token punctuation">.</span>restore<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> latest_checkpoint<span class="token punctuation">)</span></code></pre>
      </div>
<p>This class functions the same way as the class seen in the template. That is, one will inherit from this class and implement the model_construtor function. The biggest difference here is that I decided to make use of the tf.data.Dataset API. In the constructor you will notice the following lines:</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python">self<span class="token punctuation">.</span>x <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
self<span class="token punctuation">.</span>y <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>

self<span class="token punctuation">.</span>data <span class="token operator">=</span> tf<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Dataset<span class="token punctuation">.</span>from_tensor_slices<span class="token punctuation">(</span>
    <span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>batch<span class="token punctuation">(</span>
    config<span class="token punctuation">[</span><span class="token string">'batch_size'</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token punctuation">)</span>
self<span class="token punctuation">.</span>data_iter <span class="token operator">=</span> self<span class="token punctuation">.</span>data<span class="token punctuation">.</span>make_initializable_iterator<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
      </div>
<p>Here I create a placeholder for the feature vectors (x) and labels (y) and create a dataset. From this dataset I then create an initializatle iterator. This will be very benefical because later I will be able to feed in different datasets without having to rewrite parts of my code. </p>
<h3>Trainer</h3>
<p>The trainer base class has the most changes compared to the other project. It still functions the same, where one defines the epoch function, but includes the methods train, test, and predict seen below:</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> features<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Iterates over epochs preforming the training_step for each epoch.
    
    Args:
        features (np.array): The feature vectors of the training set.
        labels (np.array): The labels of the training set.
    """</span>
    <span class="token keyword">with</span> tf<span class="token punctuation">.</span>name_scope<span class="token punctuation">(</span><span class="token string">'train'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>data_iter<span class="token punctuation">.</span>initializer<span class="token punctuation">,</span> 
            feed_dict<span class="token operator">=</span><span class="token punctuation">{</span>
                self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>x<span class="token punctuation">:</span> features<span class="token punctuation">,</span>
                self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>y<span class="token punctuation">:</span> labels
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'num_epochs'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>
                <span class="token string">'Epoch %d/%d'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'num_epochs'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>epoch<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> features<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Determines the loss and accuracy of the trained model on the 
    test set.
    
    Args:
        features (np.array): The feature vectors of the test set.
        labels (np.array): The labels of the test set.
    """</span>
    self<span class="token punctuation">.</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>
        self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>data_iter<span class="token punctuation">.</span>initializer<span class="token punctuation">,</span> 
        feed_dict<span class="token operator">=</span><span class="token punctuation">{</span>
            self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>x<span class="token punctuation">:</span> features<span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>y<span class="token punctuation">:</span> labels
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">with</span> tf<span class="token punctuation">.</span>name_scope<span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        _<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> accuracy <span class="token operator">=</span> self<span class="token punctuation">.</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span>
                self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>optimizer<span class="token punctuation">,</span>
                self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">,</span>
                self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>accuracy
            <span class="token punctuation">]</span>
        <span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'test cost: '</span><span class="token punctuation">,</span> loss<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'test accuracy: '</span><span class="token punctuation">,</span> accuracy<span class="token punctuation">)</span>
        current_iteration <span class="token operator">=</span> self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>global_step<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>sess<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>log<span class="token punctuation">(</span>
            <span class="token string">'cost'</span><span class="token punctuation">,</span>
            loss<span class="token punctuation">,</span>
            current_iteration<span class="token punctuation">,</span>
            training<span class="token operator">=</span><span class="token boolean">False</span>
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>log<span class="token punctuation">(</span>
            <span class="token string">'accuracy'</span><span class="token punctuation">,</span>
            accuracy<span class="token punctuation">,</span>
            current_iteration<span class="token punctuation">,</span>
            training<span class="token operator">=</span><span class="token boolean">False</span>
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>save<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sess<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> feature<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Abstract method to fetch a prediction.
    Args:
        feature (np.array): The feature vector to predict a label of.
    """</span>
<span class="token keyword">raise</span> NotImplementedError</code></pre>
      </div>
<p>In the training method, one passes the training features and labels. Here you can see the power of the dataset API. Here the initalizer method of the data iterator is called and fed the training data. In a similar fashion the dataset API is also used in the test method to feed in the test set. Finally, I added a predict method, which is ment to be implemented by the child class in order to fetch a prediction for a single feature vector. </p>
<h3>Logger</h3>
<p>The logger is fairly straightfoward. It contains only 2 methods log and add<em>graph. The log method will log a value that is passed. It has optional arguments such as is</em>image and trainig. If is_image is true it will store the value as an image and if training is false it will log to the test summary. The add graph method will save the graph to the summary. This is useful when one wants to also view the graph in tensorboard.</p>
<h2>Example</h2>
<p>Below is an example of how to use the core classes. The example below is just a simple MLP for the MNIST dataset.</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm
<span class="token keyword">from</span> core<span class="token punctuation">.</span>model <span class="token keyword">import</span> Model
<span class="token keyword">from</span> core<span class="token punctuation">.</span>trainer <span class="token keyword">import</span> Trainer
<span class="token keyword">from</span> core<span class="token punctuation">.</span>logger <span class="token keyword">import</span> Logger


<span class="token keyword">class</span> <span class="token class-name">TestModel</span><span class="token punctuation">(</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>TestModel<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>config<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>model_constructor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>saver <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>Saver<span class="token punctuation">(</span>
            max_to_keep<span class="token operator">=</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'saver_max_to_keep'</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">model_constructor</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Constructs a simple MLP for the mnist dataset."""</span>
        n_layer_1 <span class="token operator">=</span> <span class="token number">256</span> <span class="token comment"># 1st layer number of neurons</span>
        n_layer_2 <span class="token operator">=</span> <span class="token number">256</span> <span class="token comment"># 2nd layer number of neurons</span>
        n_input <span class="token operator">=</span> <span class="token number">784</span> <span class="token comment"># MNIST data input (img shape: 28*28)</span>
        n_classes <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment"># MNIST total classes (0-9 digits)</span>

        <span class="token keyword">with</span> tf<span class="token punctuation">.</span>name_scope<span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>features<span class="token punctuation">,</span> self<span class="token punctuation">.</span>labels <span class="token operator">=</span> self<span class="token punctuation">.</span>data_iter<span class="token punctuation">.</span>get_next<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">with</span> tf<span class="token punctuation">.</span>name_scope<span class="token punctuation">(</span><span class="token string">'layer_1'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            weights <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>
                tf<span class="token punctuation">.</span>random_normal<span class="token punctuation">(</span><span class="token punctuation">[</span>n_input<span class="token punctuation">,</span> n_layer_1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                name<span class="token operator">=</span><span class="token string">'weights'</span>
            <span class="token punctuation">)</span>
            bias <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>
                tf<span class="token punctuation">.</span>random_normal<span class="token punctuation">(</span><span class="token punctuation">[</span>n_layer_1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                name<span class="token operator">=</span><span class="token string">'bias'</span>
            <span class="token punctuation">)</span>
            layer_1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>
                tf<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
                    tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>self<span class="token punctuation">.</span>features<span class="token punctuation">,</span> weights<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    bias
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>

        <span class="token keyword">with</span> tf<span class="token punctuation">.</span>name_scope<span class="token punctuation">(</span><span class="token string">'layer_2'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            weights <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>
                tf<span class="token punctuation">.</span>random_normal<span class="token punctuation">(</span><span class="token punctuation">[</span>n_layer_1<span class="token punctuation">,</span> n_layer_2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                name<span class="token operator">=</span><span class="token string">'weights'</span>
            <span class="token punctuation">)</span>
            bias <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>
                tf<span class="token punctuation">.</span>random_normal<span class="token punctuation">(</span><span class="token punctuation">[</span>n_layer_2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                name<span class="token operator">=</span><span class="token string">'bias'</span>
            <span class="token punctuation">)</span>
            layer_2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>
                tf<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
                    tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>layer_1<span class="token punctuation">,</span> weights<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    bias
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>

        <span class="token keyword">with</span> tf<span class="token punctuation">.</span>name_scope<span class="token punctuation">(</span><span class="token string">'layer_3'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            weights <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>
                tf<span class="token punctuation">.</span>random_normal<span class="token punctuation">(</span><span class="token punctuation">[</span>n_layer_2<span class="token punctuation">,</span> n_classes<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                name<span class="token operator">=</span><span class="token string">'weights'</span>
            <span class="token punctuation">)</span>
            bias <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>
                tf<span class="token punctuation">.</span>random_normal<span class="token punctuation">(</span><span class="token punctuation">[</span>n_classes<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                name<span class="token operator">=</span><span class="token string">'bias'</span>
            <span class="token punctuation">)</span>
            output <span class="token operator">=</span> tf<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>
                tf<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
                    tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>layer_2<span class="token punctuation">,</span> weights<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    bias
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>cross_entropy <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_mean<span class="token punctuation">(</span>
            tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>softmax_cross_entropy_with_logits_v2<span class="token punctuation">(</span>
                labels<span class="token operator">=</span>self<span class="token punctuation">.</span>labels<span class="token punctuation">,</span>
                logits<span class="token operator">=</span>output
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>optimizer <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>AdamOptimizer<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'learning_rate'</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span>minimize<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">,</span>
            global_step<span class="token operator">=</span>self<span class="token punctuation">.</span>global_step
        <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>pred <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>output<span class="token punctuation">)</span>
        correct_prediction <span class="token operator">=</span> tf<span class="token punctuation">.</span>equal<span class="token punctuation">(</span>
            tf<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>self<span class="token punctuation">.</span>pred<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            tf<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>self<span class="token punctuation">.</span>labels<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>accuracy <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_mean<span class="token punctuation">(</span>
            tf<span class="token punctuation">.</span>cast<span class="token punctuation">(</span>correct_prediction<span class="token punctuation">,</span> tf<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">TestTrainer</span><span class="token punctuation">(</span>Trainer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sess<span class="token punctuation">,</span> model<span class="token punctuation">,</span> logger<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>TestTrainer<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> model<span class="token punctuation">,</span> logger<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">epoch</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""The logic for a single epoch of training. Loops though the batches 
        and logs the average loss and accuracy.
        """</span>
        batch_loop <span class="token operator">=</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'iterations_per_epoch'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        losses <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        accuracies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> batch_loop<span class="token punctuation">:</span>
            loss<span class="token punctuation">,</span> accuracy <span class="token operator">=</span> self<span class="token punctuation">.</span>batch_step<span class="token punctuation">(</span><span class="token punctuation">)</span>
            losses<span class="token punctuation">.</span>append<span class="token punctuation">(</span>loss<span class="token punctuation">)</span>
            accuracies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>accuracy<span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cost: %f'</span> <span class="token operator">%</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>losses<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'accuracy: %f \n'</span> <span class="token operator">%</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>accuracies<span class="token punctuation">)</span><span class="token punctuation">)</span>


        current_iteration <span class="token operator">=</span> self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>global_step<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>sess<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>log<span class="token punctuation">(</span>
            <span class="token string">'cost'</span><span class="token punctuation">,</span>
            np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>losses<span class="token punctuation">)</span><span class="token punctuation">,</span>
            current_iteration
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>log<span class="token punctuation">(</span>
            <span class="token string">'accuracy'</span><span class="token punctuation">,</span>
            np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>accuracies<span class="token punctuation">)</span><span class="token punctuation">,</span>
            current_iteration
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>save<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sess<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">batch_step</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Calculates the loss and accuracy per batch."""</span>
        _<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> accuracy <span class="token operator">=</span> self<span class="token punctuation">.</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span>
                self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>optimizer<span class="token punctuation">,</span>
                self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">,</span>
                self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>accuracy
            <span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">return</span> loss<span class="token punctuation">,</span> accuracy

    <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> feature<span class="token punctuation">)</span><span class="token punctuation">:</span>
        prediction <span class="token operator">=</span> self<span class="token punctuation">.</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>pred<span class="token punctuation">,</span>
            feed_dict<span class="token operator">=</span><span class="token punctuation">{</span>
                self<span class="token punctuation">.</span>model<span class="token punctuation">.</span>features<span class="token punctuation">:</span> <span class="token punctuation">[</span>feature<span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">return</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>prediction<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Load mnist dataset</span>
    train<span class="token punctuation">,</span> test <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># Build training set</span>
    mnist_x<span class="token punctuation">,</span> mnist_y <span class="token operator">=</span> train
    vec_mnist_y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> y <span class="token keyword">in</span> mnist_y<span class="token punctuation">:</span>
        vec <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        vec<span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1.0</span>
        vec_mnist_y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>vec<span class="token punctuation">)</span>
    train_x <span class="token operator">=</span> mnist_x<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">60000</span><span class="token punctuation">,</span> <span class="token number">784</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
    train_y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>vec_mnist_y<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>

    <span class="token comment"># Build test set</span>
    mnist_x<span class="token punctuation">,</span> mnist_y <span class="token operator">=</span> test
    vec_mnist_y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> y <span class="token keyword">in</span> mnist_y<span class="token punctuation">:</span>
        vec <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        vec<span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1.0</span>
        vec_mnist_y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>vec<span class="token punctuation">)</span>
    test_x <span class="token operator">=</span> mnist_x<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>mnist_x<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">784</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
    test_y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>vec_mnist_y<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>

    config <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'TestModel'</span><span class="token punctuation">,</span>
        <span class="token string">'batch_size'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
        <span class="token string">'num_epochs'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token string">'iterations_per_epoch'</span><span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>train_x<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'learning_rate'</span><span class="token punctuation">:</span> <span class="token number">0.001</span><span class="token punctuation">,</span>
        <span class="token string">'summary_dir'</span><span class="token punctuation">:</span> <span class="token string">'logs'</span><span class="token punctuation">,</span>
        <span class="token string">'save_dir'</span><span class="token punctuation">:</span> <span class="token string">'snapshots'</span><span class="token punctuation">,</span>
        <span class="token string">'saver_max_to_keep'</span><span class="token punctuation">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span>

    <span class="token comment"># Instantiate the session, logger, model and trainer</span>
    sess <span class="token operator">=</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
    logger <span class="token operator">=</span> Logger<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
    model <span class="token operator">=</span> TestModel<span class="token punctuation">(</span>config<span class="token punctuation">)</span>
    trainer <span class="token operator">=</span> TestTrainer<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> model<span class="token punctuation">,</span> logger<span class="token punctuation">)</span>

    <span class="token comment"># Visualize the graph in Tensorboard</span>
    logger<span class="token punctuation">.</span>add_graph<span class="token punctuation">(</span>sess<span class="token punctuation">.</span>graph<span class="token punctuation">)</span>

    <span class="token comment"># Load the model if pre-trained</span>
    model<span class="token punctuation">.</span>load<span class="token punctuation">(</span>sess<span class="token punctuation">)</span>

    <span class="token comment"># Train</span>
    trainer<span class="token punctuation">.</span>train<span class="token punctuation">(</span>train_x<span class="token punctuation">,</span> train_y<span class="token punctuation">)</span>

    <span class="token comment"># Test</span>
    trainer<span class="token punctuation">.</span>test<span class="token punctuation">(</span>test_x<span class="token punctuation">,</span> test_y<span class="token punctuation">)</span>
    
    <span class="token comment"># Get a prediction for a single feature vector</span>
    prediction <span class="token operator">=</span> trainer<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'prediction: '</span><span class="token punctuation">,</span> prediction<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'actual: '</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>test_y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
      </div></div></div></div></div></div></div><div class="sc-ifAKCX dTpISP" data-reactid="21"><div class="sc-EHOje cDjlmj" data-reactid="22"><!-- react-text: 23 -->  ©<!-- /react-text --><!-- react-text: 24 -->2019<!-- /react-text --><!-- react-text: 25 --> <!-- /react-text --></div></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-03bf8c1ef8ee9789dabc.js","47684285815873":"component---src-templates-project-page-js-c391599eada3426ac091.js","162898551421021":"component---src-pages-404-js-4503918ea3a16cfcdb75.js","35783957827783":"component---src-pages-index-js-58d7698f603c3ef82d55.js","60335399758886":"path----9822740be8bd48004e16.js","65453555881757":"path---convex-hull-9494fff19f0258e5566e.js","278956610567942":"path---digital-graffiti-531e89ee7dd2293c1019.js","94766615434379":"path---ml-api-ce8e42e249c0ecb436ec.js","121167490327550":"path---materails-ml-app-9dac975acac2d2a86493.js","60363658840170":"path---library-of-crystallographic-prototypes-3b7815790206d384fe08.js","200281545638894":"path---materails-atlas-project-89e5bade98966b25cbd2.js","189584291892019":"path---ngdex-1f2ddf5e170c9507d8cc.js","120232950619259":"path---tf-boilerplate-c45a4220ba8acc9f02d0.js","238436551622618":"path---mern-boilerplate-eb66ce6ffb256c47fce6.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","142629428675168":"path---index-6f4ac5ca943dc1936044.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-3ef8ab9a449c73fd4e1a.js"}/*]]>*/</script><script>
            
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-125288872-1',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-125288872-1', 'auto');
      ga('set', 'anonymizeIp', 1);}
      </script><script>/*<![CDATA[*/!function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",["/commons-afb5782224ac01f1fa03.js","/app-03bf8c1ef8ee9789dabc.js","/path---tf-boilerplate-c45a4220ba8acc9f02d0.js","/component---src-templates-project-page-js-c391599eada3426ac091.js","/component---src-layouts-index-js-3ef8ab9a449c73fd4e1a.js"])/*]]>*/</script></body></html>